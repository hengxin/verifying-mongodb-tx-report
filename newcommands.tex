% newcommands.tex

% math
\newcommand{\set}[1]{\{#1\}}
\DeclareMathOperator*{\argmin}{argmin} % thin space, limits underneath in displays
\DeclareMathOperator*{\argmax}{argmax} % thin space, limits underneath in displays
\newcommand{\dom}{\ensuremath{\mathsf{dom}}}
\newcommand{\range}{\ensuremath{\mathsf{range}}}

\newcommand{\wtalg}{\textsc{WiredTiger}}
\newcommand{\rsalg}{\textsc{ReplicaSet}}
\newcommand{\scalg}{\textsc{ShardedCluster}}

\newcommand{\si}{\textsc{SI}}
\newcommand{\ansisi}{\textsc{ANSI-SI}}
\newcommand{\rtsi}{\textsc{RealtimeSI}}
\newcommand{\gsi}{\textsc{GSI}}
\newcommand{\parallelsi}{\textsc{PSI}}
\newcommand{\pcsi}{\textsc{PCSI}}
\newcommand{\strongsi}{\textsc{StrongSI}}
\newcommand{\wsi}{\textsc{WriteSI}}
\newcommand{\nmsi}{\textsc{NMSI}}
\newcommand{\strongsessionsi}{\textsc{StrongSessionSI}}
\newcommand{\sessionsi}{\textsc{SessionSI}}

%%%%%%%%%%%%%%% system models %%%%%%%%%%%%%%%
\newcommand{\E}{E}
\newcommand{\evar}{\mathit{e}}
\newcommand{\fvar}{\mathit{f}}
\newcommand{\Event}{{\sf Event}}
\newcommand{\REvent}{{\sf REvent}}
\newcommand{\WEvent}{{\sf WEvent}}
\newcommand{\HEvent}{{\sf HEvent}}
\newcommand{\op}{{\sf op}}
\newcommand{\Op}{{\sf Op}}
\newcommand{\readevent}{{\sf read}}
\newcommand{\Read}{{\sf Read}\;}
\newcommand{\writeevent}{{\sf write}}
\newcommand{\Write}{{\sf Write}\;}
\newcommand{\WriteTx}{{\sf WriteTx}}
\newcommand{\starttime}{\textsl{start}}
\newcommand{\starttimewt}{\textsl{start}_\textsl{wt}}
\newcommand{\starttimers}{\textsl{start}_\textsl{rs}}
\newcommand{\starttimesc}{\textsl{start}_\textsl{sc}}
\newcommand{\committime}{\textsl{commit}}
\newcommand{\committimewt}{\textsl{commit}_\textsl{wt}}
\newcommand{\committimers}{\textsl{commit}_\textsl{rs}}
\newcommand{\committimesc}{\textsl{commit}_\textsl{sc}}
\newcommand{\committsfunc}{\textsl{commit\_ts}}
\newcommand{\readtsfunc}{\textsl{read\_ts}}
%%%%%%%%%%%%%%% system models %%%%%%%%%%%%%%%

%%%%%%%%%%%%%%% axioms %%%%%%%%%%%%%%%
\newcommand{\h}{\mathcal{H}}
\renewcommand{\ae}{\mathcal{A}}
\newcommand{\axiom}{\Phi}
\newcommand{\rel}[1]{\xrightarrow{#1}}
\newcommand{\comp}{\;;}
\newcommand{\po}{{\sf po}}
\newcommand{\so}{\textsc{so}}
\newcommand{\sowt}{\textsc{so}_{\textsc{wt}}}
\newcommand{\sors}{\textsc{so}_{\textsc{rs}}}
\newcommand{\sosc}{\textsc{so}_{\textsc{sc}}}
\newcommand{\rb}{\textsc{rb}}
\newcommand{\rbwt}{\textsc{rb}_{\textsc{wt}}}
\newcommand{\rbrs}{\textsc{rb}_{\textsc{rs}}}
\newcommand{\rbsc}{\textsc{rb}_{\textsc{sc}}}
\newcommand{\cb}{\textsc{cb}}
\newcommand{\cbwt}{\textsc{cb}_\textsc{wt}}
\newcommand{\cbrs}{\textsc{cb}_\textsc{rs}}
\newcommand{\cbsc}{\textsc{cb}_\textsc{sc}}
\newcommand{\vis}{\textsc{vis}}
\newcommand{\viswt}{\textsc{vis}_{\textsc{wt}}}
\newcommand{\visrs}{\textsc{vis}_{\textsc{rs}}}
\newcommand{\vissc}{\textsc{vis}_{\textsc{sc}}}
\newcommand{\ar}{\textsc{ar}}
\newcommand{\arwt}{\textsc{ar}_{\textsc{wt}}}
\newcommand{\arrs}{\textsc{ar}_{\textsc{rs}}}
\newcommand{\arsc}{\textsc{ar}_{\textsc{sc}}}
\newcommand{\hist}{\text{Hist}}
\newcommand{\intaxiom}{\textsc{Int}}
\newcommand{\extaxiom}{\textsc{Ext}}
\newcommand{\sessionaxiom}{\textsc{Session}}
\newcommand{\prefixaxiom}{\textsc{Prefix}}
\newcommand{\rbaxiom}{\textsc{ReturnBefore}}
\newcommand{\cbaxiom}{\textsc{CommitBefore}}
\newcommand{\conflict}{\bowtie}
\newcommand{\noconflictaxiom}{\textsc{NoConflict}}
\newcommand{\realtimesnapshotaxiom}{\textsc{RealtimeSnapshot}}
%%%%%%%%%%%%%%% axioms %%%%%%%%%%%%%%%

\newcommand{\true}{{\sf true}}
\newcommand{\false}{{\sf false}}
\newcommand{\rollback}{{\sf rollback}}
\newcommand{\ok}{{\sf ok}}
\newcommand{\rc}{\emph{readConcern}\;}
\newcommand{\wc}{\emph{writeConcern}\;}
\newcommand{\local}{\emph{local}}
\newcommand{\majority}{\emph{majority}}
\newcommand{\snapshotrc}{\emph{snapshot}}
\newcommand{\noop}{{\sf noop}}

\newcommand{\T}{\mathbb{T}}
\newcommand{\Key}{{\sf Key}}
\newcommand{\Val}{{\sf Val}}

\newcommand{\store}{{\sf store}}
\newcommand{\key}{{\sf key}}
\newcommand{\kvar}{\mathit{k}}
\newcommand{\keyvar}{\mathit{key}}
\newcommand{\val}{{\sf val}}
\newcommand{\vvar}{\mathit{v}}
\newcommand{\valvar}{\mathit{val}}
%%%%%%%%%%%%%%% wt-tx %%%%%%%%%%%%%%%
\newcommand{\WTSID}{{\sf WT\_SID}}
\newcommand{\wtsid}{{\sf wt\_sid}}
\newcommand{\wtsidvar}{\mathit{wt\_sid}}
\newcommand{\txn}{{\sf txn}}
\newcommand{\txnvar}{\mathit{txn}}
\newcommand{\wtsession}{{\sf wt\_session}}
\newcommand{\wtsessionvar}{\mathit{wt\_session}}

\newcommand{\wttsnone}{\bot_{{\sf ts}}}
\newcommand{\wttidnone}{\bot_{{\sf tid}}}
\newcommand{\wttxnnone}{\bot_{{\sf txn}}}

\newcommand{\id}{{\sf id}}
\newcommand{\TID}{{\sf TID}}
\newcommand{\tid}{{\sf tid}}
\newcommand{\tidvar}{\mathit{tid}}
\newcommand{\wtstate}{{\sf wt\_state}}
\newcommand{\wtstatevar}{\mathit{wt\_state}}

\newcommand{\wttxnglobal}{{\sf wt\_txn\_global}}
\newcommand{\currenttid}{{\sf current\_tid}}
\newcommand{\currenttidvar}{\mathit{current\_tid}}
\newcommand{\oldestid}{{\sf oldest\_id}}
\newcommand{\oldesttidvar}{\mathit{oldest\_tid}}
\newcommand{\states}{{\sf states}}

\newcommand{\WTTXN}{{\sf WT\_TXN}}
\newcommand{\WTSESSION}{{\sf WT\_SESSION}}
\newcommand{\snapmin}{{\sf snap\_min}}
\newcommand{\snapmax}{{\sf snap\_max}}
\newcommand{\snapshot}{{\sf snapshot}}
\newcommand{\mods}{{\sf mods}}
%% wt-client
\newcommand{\wtclopen}{\textsc{wt\_cl\_open}}
\newcommand{\wtclstart}{\textsc{wt\_cl\_start}}
\newcommand{\wtclread}{\textsc{wt\_cl\_read}}
\newcommand{\wtclupdate}{\textsc{wt\_cl\_update}}
\newcommand{\wtclcommit}{\textsc{wt\_cl\_commit}}
%% wt-db
\newcommand{\wtopen}{\textsc{wt\_open}}
\newcommand{\wtclose}{\textsc{wt\_close}}
\newcommand{\wtstart}{\textsc{wt\_start}}
\newcommand{\wtread}{\textsc{wt\_read}}
\newcommand{\wtupdate}{\textsc{wt\_update}}
\newcommand{\wtcommit}{\textsc{wt\_commit}}
\newcommand{\wtrollback}{\textsc{wt\_rollback}}
\newcommand{\txnvis}{\textsc{txn\_visible}}
\newcommand{\fetchalldurablets}{\textsc{fetch\_all\_durable\_ts}}
\newcommand{\wtsetcommitts}{\textsc{wt\_set\_commit\_ts}}
%%%%%%%%%%%%%%% wt-tx %%%%%%%%%%%%%%%

%%%%%%%%%%%%%%% rs-tx %%%%%%%%%%%%%%%
\newcommand{\RSTXN}{{\sf RS\_TXN}}
\newcommand{\RSSID}{{\sf RS\_SID}}
\newcommand{\RSSESSION}{{\sf RS\_SESSION}}
\newcommand{\rssid}{{\sf rs\_sid}}
\newcommand{\rssidvar}{\mathit{rs\_sid}}
\newcommand{\rssession}{{\sf rs\_session}}
\newcommand{\rssessionvar}{\mathit{rs\_session}}
\newcommand{\isstartingtxn}{{\sf is\_starting}}
\newcommand{\OPLOG}{\textsc{oplog}}
\newcommand{\TS}{{\sf TS}}
\newcommand{\ts}{{\sf ts}}
\newcommand{\tsvar}{\mathit{ts}}
\newcommand{\readts}{{\sf read\_ts}}
\newcommand{\readtsvar}{\mathit{read\_ts}}
\newcommand{\durablets}{{\sf durable\_ts}}
\newcommand{\durabletsvar}{\mathit{durable\_ts}}
\newcommand{\alldurabletsvar}{\mathit{all\_durable\_ts}}
\newcommand{\committs}{{\sf commit\_ts}}
\newcommand{\committsvar}{\mathit{commit\_ts}}
\newcommand{\pinneddurablets}{{\sf pinned\_durable\_ts}}
\newcommand{\pinneddurabletsvar}{\mathit{p\_durable\_ts}}
\newcommand{\ops}{{\sf ops}}
\newcommand{\opsvar}{\mathit{ops}}
\newcommand{\oplog}{{\sf oplog}}
\newcommand{\oplogvar}{\mathit{oplog}}
\newcommand{\head}{\textsc{head}}
\newcommand{\last}{\textsc{last}}
\newcommand{\oplogreadts}{{\sf oplog\_read\_ts}}
\newcommand{\oploglasttsvar}{\mathit{oplog\_last\_ts}}
\newcommand{\rswtconns}{{\sf rs\_wt\_conns}}
\newcommand{\TXNPART}{{\sf TXN\_PART}}
\newcommand{\txnstate}{{\sf txn\_state}}
\newcommand{\txnops}{{\sf txn\_ops}}
\newcommand{\participants}{{\sf participants}}
\newcommand{\participantvar}{{\mathit{p}}}
\newcommand{\participantsvar}{\mathit{parts}}
%% rs-client procedures
\newcommand{\rsclopen}{\textsc{rs\_cl\_open}}
\newcommand{\rsclclose}{\textsc{rs\_cl\_close}}
\newcommand{\rsclstart}{\textsc{rs\_cl\_start}}
\newcommand{\rsclread}{\textsc{rs\_cl\_read}}
\newcommand{\rsclupdate}{\textsc{rs\_cl\_update}}
\newcommand{\rsclcommit}{\textsc{rs\_cl\_commit}}
%% rs-server procedures
\newcommand{\rsopen}{\textsc{rs\_open}}
\newcommand{\rsclose}{\textsc{rs\_close}}
\newcommand{\rsstart}{\textsc{rs\_start}}
\newcommand{\rsread}{\textsc{rs\_read}}
\newcommand{\rsupdate}{\textsc{rs\_update}}
\newcommand{\rscommit}{\textsc{rs\_commit}}
\newcommand{\rsrollback}{\textsc{rs\_rollback}}
%% utility procedures
\newcommand{\uuid}{\textsc{uuid}}
\newcommand{\openwtsession}{\textsc{open\_wt\_session}}
%% clock
\newcommand{\hlc}{\mathit{hlc}}
\renewcommand{\sec}{\mathit{sec}}
\newcommand{\counter}{\mathit{counter}}
\newcommand{\ct}{\sf ct} % cluster\_time
\newcommand{\ctvar}{\mathit{ct}}
\newcommand{\ot}{\sf optime}
\newcommand{\otvar}{\mathit{ot}}
\newcommand{\clock}{\sf clock}
\newcommand{\clockvar}{\mathit{clock}}
\newcommand{\aot}{\sf aot}
\newcommand{\tick}{\textsc{tick}}
\newcommand{\dec}{\textsc{dec}}
\newcommand{\merge}{\textsc{merge}}
\newcommand{\compare}{\textsc{compare}}
\newcommand{\noopwrite}{\textsc{noop}}
\newcommand{\replicate}{\textsc{replicate}}
\newcommand{\replication}{\textsc{replication}}
\newcommand{\pulloplog}{\textsc{pull\_oplog}}
\newcommand{\pushoplog}{\textsc{push\_oplog}}
\newcommand{\replicavar}{\mathit{r}}
\newcommand{\Primary}{\mathit{P}}
\newcommand{\primary}{\textsc{primary}}
\newcommand{\primaryvar}{\mathit{p}}
\newcommand{\isprimary}{\textsc{is\_primary}}
\newcommand{\issecondary}{\textsc{is\_secondary}}
\newcommand{\secondaryvar}{\mathit{s}}
\newcommand{\replicateack}{\textsc{replicate\_ack}}
\newcommand{\majoritycommitted}{\textsc{majority\_committed}}
\newcommand{\lastpulled}{{\sf last\_pulled}}
\newcommand{\lastpulledacks}{{\sf last\_pulled\_ack}}
\newcommand{\lastpulledvar}{\mathit{last\_pulled}}
\newcommand{\lastmajoritycommitted}{{\sf last\_majority\_committed}}
\newcommand{\lastmajoritycommittedvar}{\mathit{last\_majority\_committed}}
%%%%%%%%%%%%%%% rs-tx %%%%%%%%%%%%%%%

% style
\newcommand{\rsstyle}[1]{\underline{#1}} % replica set
\newcommand{\scstyle}[1]{\colorbox{lightgray}{$#1$}} % sharded cluster

%%%%%%%%%%%%%%% sc-tx %%%%%%%%%%%%%%%
% variables
\newcommand{\SCTXN}{{\sf SC\_TXN}}
\newcommand{\ShardID}{{\sf SHARD\_ID}}
\newcommand{\shardid}{{\sf shard\_id}}
\newcommand{\shardidvar}{\mathit{shard\_id}}
\newcommand{\svar}{\mathit{s}} % used in sc-variables.tex
\newcommand{\shardsvar}{\mathit{L}} % set of shards
\newcommand{\shardvar}{\mathit{l}} % individual shard
\newcommand{\TXNROUTER}{{\sf TXN\_ROUTER}}
\newcommand{\scroutertable}{{\sf router\_table}}
\newcommand{\routervar}{\mathit{router}}
\newcommand{\atclustertime}{{\sf at\_cluster\_time}}
\newcommand{\coordid}{{\sf coord\_id}}
\newcommand{\coordvar}{\mathit{l}_{\mathit{c}}}
\newcommand{\iscoord}{{\sf is\_coord}}
\newcommand{\status}{{\sf status}}
\newcommand{\statusvar}{\mathit{status}}
\newcommand{\inactive}{\textsc{inactive}}
\newcommand{\waitparticipants}{\textsc{wait\_participants}}
\newcommand{\waitvotes}{\textsc{wait\_votes}}
\newcommand{\writedec}{\textsc{write\_decision}}
\newcommand{\waitdecacks}{\textsc{wait\_decision\_acks}}
\newcommand{\delcoord}{\textsc{del\_coord}}
\newcommand{\readonly}{{\sf read\_only}}
\newcommand{\responsevar}{\mathit{response}}
\newcommand{\scrsconns}{{\sf sc\_rs\_conns}}
\newcommand{\scrsconnsvar}{\mathit{sc\_rs\_conns}}

% unspecified
\newcommand{\shardof}{\textsc{shard\_of}}
\newcommand{\primaryof}{\textsc{primary\_of}}

% sc client
\newcommand{\scclopen}{\textsc{sc\_cl\_open}}
\newcommand{\scclstart}{\textsc{sc\_cl\_start}}
\newcommand{\scclread}{\textsc{sc\_cl\_read}}
\newcommand{\scclupdate}{\textsc{sc\_cl\_update}}
\newcommand{\scclcommit}{\textsc{sc\_cl\_commit}}
\newcommand{\scclrollback}{\textsc{sc\_cl\_rollback}}
\newcommand{\scclclose}{\textsc{sc\_cl\_close}}

\newcommand{\SCSESSION}{{\sf SC\_SESSION}}
\newcommand{\scsession}{{\sf sc\_session}}
\newcommand{\scsessionvar}{\mathit{sc\_session}}
\newcommand{\roshards}{\mathit{ro\_shards}}

% sc mongos (router)
\newcommand{\scmongosopen}{\textsc{sc\_mongos\_open}}
\newcommand{\scmongosstart}{\textsc{sc\_mongos\_start}}
\newcommand{\scmongosread}{\textsc{sc\_mongos\_read}}
\newcommand{\scmongosupdate}{\textsc{sc\_mongos\_update}}
\newcommand{\scmongoscommit}{\textsc{sc\_mongos\_commit}}
\newcommand{\twopc}{\textsc{2pc}}
\newcommand{\twopcack}{\textsc{2pc\_ack}}
\newcommand{\continue}{\textsc{continue}}
\newcommand{\fieldsvar}{\mathit{fields}}
\newcommand{\mongosvar}{\mathit{m}}

% sc participants
\newcommand{\scread}{\textsc{sc\_read}}
\newcommand{\waitforreadconcern}{\textsc{wait\_for\_read\_concern}}
\newcommand{\scupdate}{\textsc{sc\_update}}
\newcommand{\scstart}{\textsc{sc\_start}}
\newcommand{\prepare}{\textsc{prepare}}
\newcommand{\prepareack}{\textsc{prepare\_ack}}
\newcommand{\commit}{\textsc{commit}}
\newcommand{\committed}{{\sf committed}}
\newcommand{\abort}{\textsc{abort}}
\newcommand{\decack}{\textsc{decision\_ack}}
\newcommand{\updateoplogvisibility}{\textsc{update\_oplog\_visibility}}

\newcommand{\wtprepare}{\textsc{wt\_prepare}}
\newcommand{\wtprepareinprogress}{\textsc{wt\_prepared}}
\newcommand{\wtprepareresolved}{\textsc{wt\_committed}}
\newcommand{\wtsetreadts}{\textsc{wt\_set\_read\_ts}}

\newcommand{\commitdecision}{{\sf commit}}
\newcommand{\abortdecision}{{\sf abort}}

\newcommand{\preparets}{{\sf prepare\_ts}}
\newcommand{\preparetsvar}{\mathit{prepare\_ts}}
\newcommand{\votevar}{\mathit{vote}}
\newcommand{\decvar}{\mathit{decision}}

\newcommand{\wtcommitprepare}{\textsc{wt\_commit\_prepare}}
\newcommand{\wtcommitpreparets}{\textsc{wt\_commit\_prepare\_ts}}

\newcommand{\waitproc}{\textsc{wait}}
\newcommand{\notifyall}{\textsc{notify\_all}}
\newcommand{\preparecommittedorabortedcond}{{\sf decided\_cond}}

\newcommand{\case}{\textsc{Case}}
\newcommand{\caseclockskew}{\case-\textsc{Clock-Skew}}
\newcommand{\casependingcommitread}{\case-\textsc{Pending-Commit-Read}}
\newcommand{\casependingcommitupdate}{\case-\textsc{Pending-Commit-Update}}
\newcommand{\caseholes}{\case-\textsc{Holes}}
%%%%%%%%%%%%%%% sc-tx %%%%%%%%%%%%%%%